"use strict";var Fr=Object.create;var Ve=Object.defineProperty;var Gr=Object.getOwnPropertyDescriptor;var Cr=Object.getOwnPropertyNames;var Ur=Object.getPrototypeOf,jr=Object.prototype.hasOwnProperty;var $r=(c,l)=>()=>(l||c((l={exports:{}}).exports,l),l.exports),zr=(c,l)=>{for(var p in l)Ve(c,p,{get:l[p],enumerable:!0})},In=(c,l,p,h)=>{if(l&&typeof l=="object"||typeof l=="function")for(let b of Cr(l))!jr.call(c,b)&&b!==p&&Ve(c,b,{get:()=>l[b],enumerable:!(h=Gr(l,b))||h.enumerable});return c};var xn=(c,l,p)=>(p=c!=null?Fr(Ur(c)):{},In(l||!c||!c.__esModule?Ve(p,"default",{value:c,enumerable:!0}):p,c)),Wr=c=>In(Ve({},"__esModule",{value:!0}),c);var Rn=$r((tt,fe)=>{"use strict";var Ze=void 0,et=function(c){return Ze||(Ze=new Promise(function(l,p){var h=typeof c<"u"?c:{},b=h.onAbort;h.onAbort=function(e){p(new Error(e)),b&&b(e)},h.postRun=h.postRun||[],h.postRun.push(function(){l(h)}),fe=void 0;var i;i||(i=typeof h<"u"?h:{}),i.onRuntimeInitialized=function(){function e(a,f){this.La=a,this.db=f,this.Ja=1,this.eb=[]}function t(a,f){if(this.db=f,f=he(a)+1,this.Ya=ze(f),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");oe(a,U,this.Ya,f),this.cb=this.Ya,this.Ua=this.ib=null}function n(a){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),a!=null){var f=this.filename,y="/",g=f;if(y&&(y=typeof y=="string"?y:Ee(y),g=f?J(y+"/"+f):y),f=dn(!0,!0),g=He(g,(f!==void 0?f:438)&4095|32768,0),a){if(typeof a=="string"){y=Array(a.length);for(var q=0,$=a.length;q<$;++q)y[q]=a.charCodeAt(q);a=y}Fe(g,f|146),y=le(g,577),fn(y,a,0,a.length,0,void 0),_t(y),Fe(g,f)}}this.handleError(s(this.filename,r)),this.db=V(r,"i32"),Hr(this.db),this.Za={},this.Ra={}}var r=Y(4),o=i.cwrap,s=o("sqlite3_open","number",["string","number"]),m=o("sqlite3_close_v2","number",["number"]),_=o("sqlite3_exec","number",["number","string","number","number","number"]),v=o("sqlite3_changes","number",["number"]),k=o("sqlite3_prepare_v2","number",["number","string","number","number","number"]),T=o("sqlite3_sql","string",["number"]),X=o("sqlite3_normalized_sql","string",["number"]),It=o("sqlite3_prepare_v2","number",["number","number","number","number","number"]),fr=o("sqlite3_bind_text","number",["number","number","number","number","number"]),vn=o("sqlite3_bind_blob","number",["number","number","number","number","number"]),pr=o("sqlite3_bind_double","number",["number","number","number"]),mr=o("sqlite3_bind_int","number",["number","number","number"]),dr=o("sqlite3_bind_parameter_index","number",["number","string"]),hr=o("sqlite3_step","number",["number"]),yr=o("sqlite3_errmsg","string",["number"]),gr=o("sqlite3_column_count","number",["number"]),br=o("sqlite3_data_count","number",["number"]),wr=o("sqlite3_column_double","number",["number","number"]),Sn=o("sqlite3_column_text","string",["number","number"]),_r=o("sqlite3_column_blob","number",["number","number"]),vr=o("sqlite3_column_bytes","number",["number","number"]),Sr=o("sqlite3_column_type","number",["number","number"]),kr=o("sqlite3_column_name","string",["number","number"]),Dr=o("sqlite3_reset","number",["number"]),Er=o("sqlite3_clear_bindings","number",["number"]),Ir=o("sqlite3_finalize","number",["number"]),xr=o("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),qr=o("sqlite3_value_type","number",["number"]),Ar=o("sqlite3_value_bytes","number",["number"]),Mr=o("sqlite3_value_text","string",["number"]),Pr=o("sqlite3_value_blob","number",["number"]),Rr=o("sqlite3_value_double","number",["number"]),Tr=o("sqlite3_result_double","",["number","number"]),kn=o("sqlite3_result_null","",["number"]),Nr=o("sqlite3_result_text","",["number","string","number","number"]),Lr=o("sqlite3_result_blob","",["number","number","number","number"]),Br=o("sqlite3_result_int","",["number","number"]),Dn=o("sqlite3_result_error","",["number","string","number"]),Hr=o("RegisterExtensionFunctions","number",["number"]);e.prototype.bind=function(a){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(a)?this.xb(a):a!=null&&typeof a=="object"?this.yb(a):!0},e.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var a=hr(this.La);switch(a){case 100:return!0;case 101:return!1;default:throw this.db.handleError(a)}},e.prototype.sb=function(a){return a==null&&(a=this.Ja,this.Ja+=1),wr(this.La,a)},e.prototype.Cb=function(a){if(a==null&&(a=this.Ja,this.Ja+=1),a=Sn(this.La,a),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(a)},e.prototype.Db=function(a){return a==null&&(a=this.Ja,this.Ja+=1),Sn(this.La,a)},e.prototype.getBlob=function(a){a==null&&(a=this.Ja,this.Ja+=1);var f=vr(this.La,a);a=_r(this.La,a);for(var y=new Uint8Array(f),g=0;g<f;g+=1)y[g]=A[a+g];return y},e.prototype.get=function(a,f){f=f||{},a!=null&&this.bind(a)&&this.step(),a=[];for(var y=br(this.La),g=0;g<y;g+=1)switch(Sr(this.La,g)){case 1:var q=f.useBigInt?this.Cb(g):this.sb(g);a.push(q);break;case 2:a.push(this.sb(g));break;case 3:a.push(this.Db(g));break;case 4:a.push(this.getBlob(g));break;default:a.push(null)}return a},e.prototype.getColumnNames=function(){for(var a=[],f=gr(this.La),y=0;y<f;y+=1)a.push(kr(this.La,y));return a},e.prototype.getAsObject=function(a,f){a=this.get(a,f),f=this.getColumnNames();for(var y={},g=0;g<f.length;g+=1)y[f[g]]=a[g];return y},e.prototype.getSQL=function(){return T(this.La)},e.prototype.getNormalizedSQL=function(){return X(this.La)},e.prototype.run=function(a){return a!=null&&this.bind(a),this.step(),this.reset()},e.prototype.nb=function(a,f){f==null&&(f=this.Ja,this.Ja+=1),a=bn(a);var y=ut(a);this.eb.push(y),this.db.handleError(fr(this.La,f,y,a.length-1,0))},e.prototype.wb=function(a,f){f==null&&(f=this.Ja,this.Ja+=1);var y=ut(a);this.eb.push(y),this.db.handleError(vn(this.La,f,y,a.length,0))},e.prototype.mb=function(a,f){f==null&&(f=this.Ja,this.Ja+=1),this.db.handleError((a===(a|0)?mr:pr)(this.La,f,a))},e.prototype.zb=function(a){a==null&&(a=this.Ja,this.Ja+=1),vn(this.La,a,0,0,0)},e.prototype.ob=function(a,f){switch(f==null&&(f=this.Ja,this.Ja+=1),typeof a){case"string":this.nb(a,f);return;case"number":this.mb(a,f);return;case"bigint":this.nb(a.toString(),f);return;case"boolean":this.mb(a+0,f);return;case"object":if(a===null){this.zb(f);return}if(a.length!=null){this.wb(a,f);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+a+")."},e.prototype.yb=function(a){var f=this;return Object.keys(a).forEach(function(y){var g=dr(f.La,y);g!==0&&f.ob(a[y],g)}),!0},e.prototype.xb=function(a){for(var f=0;f<a.length;f+=1)this.ob(a[f],f+1);return!0},e.prototype.reset=function(){return this.freemem(),Er(this.La)===0&&Dr(this.La)===0},e.prototype.freemem=function(){for(var a;(a=this.eb.pop())!==void 0;)We(a)},e.prototype.free=function(){this.freemem();var a=Ir(this.La)===0;return delete this.db.Za[this.La],this.La=0,a},t.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var a=qe(),f=Y(4);ke(r),ke(f);try{this.db.handleError(It(this.db.db,this.cb,-1,r,f)),this.cb=V(f,"i32");var y=V(r,"i32");return y===0?(this.gb(),{done:!0}):(this.Ua=new e(y,this.db),this.db.Za[y]=this.Ua,{value:this.Ua,done:!1})}catch(g){throw this.ib=M(this.cb),this.gb(),g}finally{Ae(a)}},t.prototype.gb=function(){We(this.Ya),this.Ya=null},t.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:M(this.cb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(t.prototype[Symbol.iterator]=function(){return this}),n.prototype.run=function(a,f){if(!this.db)throw"Database closed";if(f){a=this.prepare(a,f);try{a.step()}finally{a.free()}}else this.handleError(_(this.db,a,0,0,r));return this},n.prototype.exec=function(a,f,y){if(!this.db)throw"Database closed";var g=qe(),q=null;try{var $=he(a)+1,O=Y($);oe(a,A,O,$);var we=O,ce=Y(4);for(a=[];V(we,"i8")!==0;){ke(r),ke(ce),this.handleError(It(this.db,we,-1,r,ce));var L=V(r,"i32");if(we=V(ce,"i32"),L!==0){for($=null,q=new e(L,this),f!=null&&q.bind(f);q.step();)$===null&&($={columns:q.getColumnNames(),values:[]},a.push($)),$.values.push(q.get(null,y));q.free()}}return a}catch(z){throw q&&q.free(),z}finally{Ae(g)}},n.prototype.each=function(a,f,y,g,q){typeof f=="function"&&(g=y,y=f,f=void 0),a=this.prepare(a,f);try{for(;a.step();)y(a.getAsObject(null,q))}finally{a.free()}if(typeof g=="function")return g()},n.prototype.prepare=function(a,f){if(ke(r),this.handleError(k(this.db,a,-1,r,0)),a=V(r,"i32"),a===0)throw"Nothing to prepare";var y=new e(a,this);return f!=null&&y.bind(f),this.Za[a]=y},n.prototype.iterateStatements=function(a){return new t(a,this)},n.prototype.export=function(){Object.values(this.Za).forEach(function(f){f.free()}),Object.values(this.Ra).forEach(st),this.Ra={},this.handleError(m(this.db));var a=ur(this.filename);return this.handleError(s(this.filename,r)),this.db=V(r,"i32"),a},n.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(a){a.free()}),Object.values(this.Ra).forEach(st),this.Ra={},this.handleError(m(this.db)),on("/"+this.filename),this.db=null)},n.prototype.handleError=function(a){if(a===0)return null;throw a=yr(this.db),Error(a)},n.prototype.getRowsModified=function(){return v(this.db)},n.prototype.create_function=function(a,f){Object.prototype.hasOwnProperty.call(this.Ra,a)&&(st(this.Ra[a]),delete this.Ra[a]);var y=Wn(function(g,q,$){for(var O,we=[],ce=0;ce<q;ce+=1){var L=V($+4*ce,"i32"),z=qr(L);if(z===1||z===2)L=Rr(L);else if(z===3)L=Mr(L);else if(z===4){z=L,L=Ar(z),z=Pr(z);for(var En=new Uint8Array(L),Qe=0;Qe<L;Qe+=1)En[Qe]=A[z+Qe];L=En}else L=null;we.push(L)}try{O=f.apply(null,we)}catch(Or){Dn(g,Or,-1);return}switch(typeof O){case"boolean":Br(g,O?1:0);break;case"number":Tr(g,O);break;case"string":Nr(g,O,-1,-1);break;case"object":O===null?kn(g):O.length!=null?(q=ut(O),Lr(g,q,O.length,-1),We(q)):Dn(g,"Wrong API use : tried to return a value of an unknown type ("+O+").",-1);break;default:kn(g)}});return this.Ra[a]=y,this.handleError(xr(this.db,a,f.length,1,0,y,0,0,0)),this},i.Database=n};var S=Object.assign({},i),N="./this.program",Pe=typeof window=="object",W=typeof importScripts=="function",H=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",P="",ve,Z,pe,me,E,R;H?(P=W?require("path").dirname(P)+"/":__dirname+"/",R=()=>{E||(me=require("fs"),E=require("path"))},ve=function(e,t){return R(),e=E.normalize(e),me.readFileSync(e,t?void 0:"utf8")},pe=e=>(e=ve(e,!0),e.buffer||(e=new Uint8Array(e)),e),Z=(e,t,n)=>{R(),e=E.normalize(e),me.readFile(e,function(r,o){r?n(r):t(o.buffer)})},1<process.argv.length&&(N=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),typeof fe<"u"&&(fe.exports=i),i.inspect=function(){return"[Emscripten Module object]"}):(Pe||W)&&(W?P=self.location.href:typeof document<"u"&&document.currentScript&&(P=document.currentScript.src),P=P.indexOf("blob:")!==0?P.substr(0,P.replace(/[?#].*/,"").lastIndexOf("/")+1):"",ve=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},W&&(pe=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Z=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{r.status==200||r.status==0&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var Re=i.print||console.log.bind(console),re=i.printErr||console.warn.bind(console);Object.assign(i,S),S=null,i.thisProgram&&(N=i.thisProgram);var ot=[],ie;function Wn(e){if(!ie){ie=new WeakMap;for(var t=se.length,n=0;n<0+t;n++){var r=Ne(n);r&&ie.set(r,n)}}if(ie.has(e))return ie.get(e);if(ot.length)t=ot.pop();else{try{se.grow(1)}catch(s){throw s instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":s}t=se.length-1}try{n=t,se.set(n,e),ye[n]=e}catch(s){if(!(s instanceof TypeError))throw s;if(typeof WebAssembly.Function=="function"){r={i:"i32",j:"i64",f:"f32",d:"f64"};var o={parameters:[],results:[]};for(n=1;4>n;++n)o.parameters.push(r["viii"[n]]);r=new WebAssembly.Function(o,e)}else{for(r=[1,0,1,96],o={i:127,j:126,f:125,d:124},r.push(3),n=0;3>n;++n)r.push(o["iii"[n]]);r.push(0),r[1]=r.length-2,n=new Uint8Array([0,97,115,109,1,0,0,0].concat(r,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),n=new WebAssembly.Module(n),r=new WebAssembly.Instance(n,{e:{f:e}}).exports.f}n=t,se.set(n,r),ye[n]=r}return ie.set(e,t),t}function st(e){ie.delete(Ne(e)),ot.push(e)}var Se;i.wasmBinary&&(Se=i.wasmBinary);var ti=i.noExitRuntime||!0;typeof WebAssembly!="object"&&ee("no native wasm support detected");function ke(e){var t="i32";switch(t.charAt(t.length-1)==="*"&&(t="i32"),t){case"i1":A[e>>0]=0;break;case"i8":A[e>>0]=0;break;case"i16":Te[e>>1]=0;break;case"i32":d[e>>2]=0;break;case"i64":G=[0,(x=0,1<=+Math.abs(x)?0<x?(Math.min(+Math.floor(x/4294967296),4294967295)|0)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],d[e>>2]=G[0],d[e+4>>2]=G[1];break;case"float":ct[e>>2]=0;break;case"double":ft[e>>3]=0;break;default:ee("invalid type for setValue: "+t)}}function V(e,t="i8"){switch(t.charAt(t.length-1)==="*"&&(t="i32"),t){case"i1":return A[e>>0];case"i8":return A[e>>0];case"i16":return Te[e>>1];case"i32":return d[e>>2];case"i64":return d[e>>2];case"float":return ct[e>>2];case"double":return Number(ft[e>>3]);default:ee("invalid type for getValue: "+t)}return null}var at,Ht=!1;function Kn(e,t,n,r){var o={string:function(k){var T=0;if(k!=null&&k!==0){var X=(k.length<<2)+1;T=Y(X),oe(k,U,T,X)}return T},array:function(k){var T=Y(k.length);return A.set(k,T),T}};e=i["_"+e];var s=[],m=0;if(r)for(var _=0;_<r.length;_++){var v=o[n[_]];v?(m===0&&(m=qe()),s[_]=v(r[_])):s[_]=r[_]}return n=e.apply(null,s),n=function(k){return m!==0&&Ae(m),t==="string"?M(k):t==="boolean"?!!k:k}(n)}var Qn=0,Vn=1;function ut(e){var t=Qn==Vn?Y(e.length):ze(e.length);return e.subarray||e.slice||(e=new Uint8Array(e)),U.set(e,t),t}var Ot=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function de(e,t,n){var r=t+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&Ot)return Ot.decode(e.subarray(t,n));for(r="";t<n;){var o=e[t++];if(o&128){var s=e[t++]&63;if((o&224)==192)r+=String.fromCharCode((o&31)<<6|s);else{var m=e[t++]&63;o=(o&240)==224?(o&15)<<12|s<<6|m:(o&7)<<18|s<<12|m<<6|e[t++]&63,65536>o?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode(55296|o>>10,56320|o&1023))}}else r+=String.fromCharCode(o)}return r}function M(e,t){return e?de(U,e,t):""}function oe(e,t,n,r){if(!(0<r))return 0;var o=n;r=n+r-1;for(var s=0;s<e.length;++s){var m=e.charCodeAt(s);if(55296<=m&&57343>=m){var _=e.charCodeAt(++s);m=65536+((m&1023)<<10)|_&1023}if(127>=m){if(n>=r)break;t[n++]=m}else{if(2047>=m){if(n+1>=r)break;t[n++]=192|m>>6}else{if(65535>=m){if(n+2>=r)break;t[n++]=224|m>>12}else{if(n+3>=r)break;t[n++]=240|m>>18,t[n++]=128|m>>12&63}t[n++]=128|m>>6&63}t[n++]=128|m&63}}return t[n]=0,n-o}function he(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);55296<=r&&57343>=r&&(r=65536+((r&1023)<<10)|e.charCodeAt(++n)&1023),127>=r?++t:t=2047>=r?t+2:65535>=r?t+3:t+4}return t}function Ft(e){var t=he(e)+1,n=ze(t);return n&&oe(e,A,n,t),n}var lt,A,U,Te,d,ct,ft;function Gt(){var e=at.buffer;lt=e,i.HEAP8=A=new Int8Array(e),i.HEAP16=Te=new Int16Array(e),i.HEAP32=d=new Int32Array(e),i.HEAPU8=U=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=new Uint32Array(e),i.HEAPF32=ct=new Float32Array(e),i.HEAPF64=ft=new Float64Array(e)}var se,Ct=[],Ut=[],jt=[];function Jn(){var e=i.preRun.shift();Ct.unshift(e)}var ae=0,pt=null,De=null;i.preloadedImages={},i.preloadedAudios={};function ee(e){throw i.onAbort&&i.onAbort(e),e="Aborted("+e+")",re(e),Ht=!0,new WebAssembly.RuntimeError(e+". Build with -s ASSERTIONS=1 for more info.")}function $t(){return F.startsWith("data:application/octet-stream;base64,")}var F;if(F="sql-wasm.wasm",!$t()){var zt=F;F=i.locateFile?i.locateFile(zt,P):P+zt}function Wt(){var e=F;try{if(e==F&&Se)return new Uint8Array(Se);if(pe)return pe(e);throw"both async and sync fetching of the wasm failed"}catch(t){ee(t)}}function Yn(){if(!Se&&(Pe||W)){if(typeof fetch=="function"&&!F.startsWith("file://"))return fetch(F,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+F+"'";return e.arrayBuffer()}).catch(function(){return Wt()});if(Z)return new Promise(function(e,t){Z(F,function(n){e(new Uint8Array(n))},t)})}return Promise.resolve().then(function(){return Wt()})}var x,G;function mt(e){for(;0<e.length;){var t=e.shift();if(typeof t=="function")t(i);else{var n=t.Jb;typeof n=="number"?t.fb===void 0?Ne(n)():Ne(n)(t.fb):n(t.fb===void 0?null:t.fb)}}}var ye=[];function Ne(e){var t=ye[e];return t||(e>=ye.length&&(ye.length=e+1),ye[e]=t=se.get(e)),t}function dt(e,t){for(var n=0,r=e.length-1;0<=r;r--){var o=e[r];o==="."?e.splice(r,1):o===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e}function J(e){var t=e.charAt(0)==="/",n=e.substr(-1)==="/";return(e=dt(e.split("/").filter(function(r){return!!r}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function Xn(e){var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],!e&&!t?".":(t&&(t=t.substr(0,t.length-1)),e+t)}function Le(e){if(e==="/")return"/";e=J(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)}function Zn(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}if(H)try{var t=require("crypto");return function(){return t.randomBytes(1)[0]}}catch{}return function(){ee("randomDevice")}}function Be(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){if(t=0<=n?arguments[n]:"/",typeof t!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t=t.charAt(0)==="/"}return e=dt(e.split("/").filter(function(r){return!!r}),!t).join("/"),(t?"/":"")+e||"."}var Kt=[];function Qt(e,t){Kt[e]={input:[],output:[],Xa:t},bt(e,er)}var er={open:function(e){var t=Kt[e.node.rdev];if(!t)throw new u(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.Xa.flush(e.tty)},flush:function(e){e.tty.Xa.flush(e.tty)},read:function(e,t,n,r){if(!e.tty||!e.tty.Xa.tb)throw new u(60);for(var o=0,s=0;s<r;s++){try{var m=e.tty.Xa.tb(e.tty)}catch{throw new u(29)}if(m===void 0&&o===0)throw new u(6);if(m==null)break;o++,t[n+s]=m}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,n,r){if(!e.tty||!e.tty.Xa.jb)throw new u(60);try{for(var o=0;o<r;o++)e.tty.Xa.jb(e.tty,t[n+o])}catch{throw new u(29)}return r&&(e.node.timestamp=Date.now()),o}},tr={tb:function(e){if(!e.input.length){var t=null;if(H){var n=Buffer.alloc(256),r=0;try{r=me.readSync(process.stdin.fd,n,0,256,-1)}catch(o){if(o.toString().includes("EOF"))r=0;else throw o}0<r?t=n.slice(0,r).toString("utf-8"):t=null}else typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t!==null&&(t+=`
`));if(!t)return null;e.input=bn(t,!0)}return e.input.shift()},jb:function(e,t){t===null||t===10?(Re(de(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(Re(de(e.output,0)),e.output=[])}},nr={jb:function(e,t){t===null||t===10?(re(de(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(re(de(e.output,0)),e.output=[])}},w={Pa:null,Qa:function(){return w.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if((n&61440)===24576||(n&61440)===4096)throw new u(63);return w.Pa||(w.Pa={dir:{node:{Oa:w.Ga.Oa,Na:w.Ga.Na,lookup:w.Ga.lookup,$a:w.Ga.$a,rename:w.Ga.rename,unlink:w.Ga.unlink,rmdir:w.Ga.rmdir,readdir:w.Ga.readdir,symlink:w.Ga.symlink},stream:{Ta:w.Ha.Ta}},file:{node:{Oa:w.Ga.Oa,Na:w.Ga.Na},stream:{Ta:w.Ha.Ta,read:w.Ha.read,write:w.Ha.write,lb:w.Ha.lb,ab:w.Ha.ab,bb:w.Ha.bb}},link:{node:{Oa:w.Ga.Oa,Na:w.Ga.Na,readlink:w.Ga.readlink},stream:{}},pb:{node:{Oa:w.Ga.Oa,Na:w.Ga.Na},stream:ar}}),n=Xt(e,t,n,r),(n.mode&61440)===16384?(n.Ga=w.Pa.dir.node,n.Ha=w.Pa.dir.stream,n.Ia={}):(n.mode&61440)===32768?(n.Ga=w.Pa.file.node,n.Ha=w.Pa.file.stream,n.Ma=0,n.Ia=null):(n.mode&61440)===40960?(n.Ga=w.Pa.link.node,n.Ha=w.Pa.link.stream):(n.mode&61440)===8192&&(n.Ga=w.Pa.pb.node,n.Ha=w.Pa.pb.stream),n.timestamp=Date.now(),e&&(e.Ia[t]=n,e.timestamp=n.timestamp),n},Kb:function(e){return e.Ia?e.Ia.subarray?e.Ia.subarray(0,e.Ma):new Uint8Array(e.Ia):new Uint8Array(0)},qb:function(e,t){var n=e.Ia?e.Ia.length:0;n>=t||(t=Math.max(t,n*(1048576>n?2:1.125)>>>0),n!=0&&(t=Math.max(t,256)),n=e.Ia,e.Ia=new Uint8Array(t),0<e.Ma&&e.Ia.set(n.subarray(0,e.Ma),0))},Gb:function(e,t){if(e.Ma!=t)if(t==0)e.Ia=null,e.Ma=0;else{var n=e.Ia;e.Ia=new Uint8Array(t),n&&e.Ia.set(n.subarray(0,Math.min(t,e.Ma))),e.Ma=t}},Ga:{Oa:function(e){var t={};return t.dev=(e.mode&61440)===8192?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,(e.mode&61440)===16384?t.size=4096:(e.mode&61440)===32768?t.size=e.Ma:(e.mode&61440)===40960?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.Ab=4096,t.blocks=Math.ceil(t.size/t.Ab),t},Na:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&w.Gb(e,t.size)},lookup:function(){throw yt[44]},$a:function(e,t,n,r){return w.createNode(e,t,n,r)},rename:function(e,t,n){if((e.mode&61440)===16384){try{var r=ue(t,n)}catch{}if(r)for(var o in r.Ia)throw new u(55)}delete e.parent.Ia[e.name],e.parent.timestamp=Date.now(),e.name=n,t.Ia[n]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.Ia[t],e.timestamp=Date.now()},rmdir:function(e,t){var n=ue(e,t),r;for(r in n.Ia)throw new u(55);delete e.Ia[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."],n;for(n in e.Ia)e.Ia.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){return e=w.createNode(e,t,41471,0),e.link=n,e},readlink:function(e){if((e.mode&61440)!==40960)throw new u(28);return e.link}},Ha:{read:function(e,t,n,r,o){var s=e.node.Ia;if(o>=e.node.Ma)return 0;if(e=Math.min(e.node.Ma-o,r),8<e&&s.subarray)t.set(s.subarray(o,o+e),n);else for(r=0;r<e;r++)t[n+r]=s[o+r];return e},write:function(e,t,n,r,o,s){if(t.buffer===A.buffer&&(s=!1),!r)return 0;if(e=e.node,e.timestamp=Date.now(),t.subarray&&(!e.Ia||e.Ia.subarray)){if(s)return e.Ia=t.subarray(n,n+r),e.Ma=r;if(e.Ma===0&&o===0)return e.Ia=t.slice(n,n+r),e.Ma=r;if(o+r<=e.Ma)return e.Ia.set(t.subarray(n,n+r),o),r}if(w.qb(e,o+r),e.Ia.subarray&&t.subarray)e.Ia.set(t.subarray(n,n+r),o);else for(s=0;s<r;s++)e.Ia[o+s]=t[n+s];return e.Ma=Math.max(e.Ma,o+r),r},Ta:function(e,t,n){if(n===1?t+=e.position:n===2&&(e.node.mode&61440)===32768&&(t+=e.node.Ma),0>t)throw new u(28);return t},lb:function(e,t,n){w.qb(e.node,t+n),e.node.Ma=Math.max(e.node.Ma,t+n)},ab:function(e,t,n,r,o,s){if(t!==0)throw new u(28);if((e.node.mode&61440)!==32768)throw new u(43);if(e=e.node.Ia,s&2||e.buffer!==lt){if((0<r||r+n<e.length)&&(e.subarray?e=e.subarray(r,r+n):e=Array.prototype.slice.call(e,r,r+n)),r=!0,n=65536*Math.ceil(n/65536),(s=_n(65536,n))?(U.fill(0,s,s+n),n=s):n=0,!n)throw new u(48);A.set(e,n)}else r=!1,n=e.byteOffset;return{Fb:n,vb:r}},bb:function(e,t,n,r,o){if((e.node.mode&61440)!==32768)throw new u(43);return o&2||w.Ha.write(e,t,0,r,n,!1),0}}},ht=null,Vt={},j=[],rr=1,te=null,Jt=!0,u=null,yt={},B=(e,t={})=>{if(e=Be("/",e),!e)return{path:"",node:null};if(t=Object.assign({rb:!0,kb:0},t),8<t.kb)throw new u(32);e=dt(e.split("/").filter(m=>!!m),!1);for(var n=ht,r="/",o=0;o<e.length;o++){var s=o===e.length-1;if(s&&t.parent)break;if(n=ue(n,e[o]),r=J(r+"/"+e[o]),n.Va&&(!s||s&&t.rb)&&(n=n.Va.root),!s||t.Sa){for(s=0;(n.mode&61440)===40960;)if(n=sn(r),r=Be(Xn(r),n),n=B(r,{kb:t.kb+1}).node,40<s++)throw new u(32)}}return{path:r,node:n}},Ee=e=>{for(var t;;){if(e===e.parent)return e=e.Qa.ub,t?e[e.length-1]!=="/"?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}},gt=(e,t)=>{for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%te.length},Yt=e=>{var t=gt(e.parent.id,e.name);if(te[t]===e)te[t]=e.Wa;else for(t=te[t];t;){if(t.Wa===e){t.Wa=e.Wa;break}t=t.Wa}},ue=(e,t)=>{var n;if(n=(n=ge(e,"x"))?n:e.Ga.lookup?0:2)throw new u(n,e);for(n=te[gt(e.id,t)];n;n=n.Wa){var r=n.name;if(n.parent.id===e.id&&r===t)return n}return e.Ga.lookup(e,t)},Xt=(e,t,n,r)=>(e=new gn(e,t,n,r),t=gt(e.parent.id,e.name),e.Wa=te[t],te[t]=e),ir={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},Zt=e=>{var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},ge=(e,t)=>{if(Jt)return 0;if(!t.includes("r")||e.mode&292){if(t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73))return 2}else return 2;return 0},en=(e,t)=>{try{return ue(e,t),20}catch{}return ge(e,"wx")},tn=(e,t,n)=>{try{var r=ue(e,t)}catch(o){return o.Ka}if(e=ge(e,"wx"))return e;if(n){if((r.mode&61440)!==16384)return 54;if(r===r.parent||Ee(r)==="/")return 10}else if((r.mode&61440)===16384)return 31;return 0},or=(e=0,t=4096)=>{for(;e<=t;e++)if(!j[e])return e;throw new u(33)},sr=(e,t)=>(Ge||(Ge=function(){},Ge.prototype={}),e=Object.assign(new Ge,e),t=or(t,void 0),e.fd=t,j[t]=e),ar={open:e=>{e.Ha=Vt[e.node.rdev].Ha,e.Ha.open&&e.Ha.open(e)},Ta:()=>{throw new u(70)}},bt=(e,t)=>{Vt[e]={Ha:t}},nn=(e,t)=>{var n=t==="/",r=!t;if(n&&ht)throw new u(10);if(!n&&!r){var o=B(t,{rb:!1});if(t=o.path,o=o.node,o.Va)throw new u(10);if((o.mode&61440)!==16384)throw new u(54)}t={type:e,Lb:{},ub:t,Eb:[]},e=e.Qa(t),e.Qa=t,t.root=e,n?ht=e:o&&(o.Va=t,o.Qa&&o.Qa.Eb.push(t))},He=(e,t,n)=>{var r=B(e,{parent:!0}).node;if(e=Le(e),!e||e==="."||e==="..")throw new u(28);var o=en(r,e);if(o)throw new u(o);if(!r.Ga.$a)throw new u(63);return r.Ga.$a(r,e,t,n)},K=(e,t)=>He(e,(t!==void 0?t:511)&1023|16384,0),Oe=(e,t,n)=>{typeof n>"u"&&(n=t,t=438),He(e,t|8192,n)},wt=(e,t)=>{if(!Be(e))throw new u(44);var n=B(t,{parent:!0}).node;if(!n)throw new u(44);t=Le(t);var r=en(n,t);if(r)throw new u(r);if(!n.Ga.symlink)throw new u(63);n.Ga.symlink(n,t,e)},rn=e=>{var t=B(e,{parent:!0}).node;e=Le(e);var n=ue(t,e),r=tn(t,e,!0);if(r)throw new u(r);if(!t.Ga.rmdir)throw new u(63);if(n.Va)throw new u(10);t.Ga.rmdir(t,e),Yt(n)},on=e=>{var t=B(e,{parent:!0}).node;if(!t)throw new u(44);e=Le(e);var n=ue(t,e),r=tn(t,e,!1);if(r)throw new u(r);if(!t.Ga.unlink)throw new u(63);if(n.Va)throw new u(10);t.Ga.unlink(t,e),Yt(n)},sn=e=>{if(e=B(e).node,!e)throw new u(44);if(!e.Ga.readlink)throw new u(28);return Be(Ee(e.parent),e.Ga.readlink(e))},Ie=(e,t)=>{if(e=B(e,{Sa:!t}).node,!e)throw new u(44);if(!e.Ga.Oa)throw new u(63);return e.Ga.Oa(e)},an=e=>Ie(e,!0),Fe=(e,t)=>{if(e=typeof e=="string"?B(e,{Sa:!0}).node:e,!e.Ga.Na)throw new u(63);e.Ga.Na(e,{mode:t&4095|e.mode&-4096,timestamp:Date.now()})},un=(e,t)=>{if(0>t)throw new u(28);if(e=typeof e=="string"?B(e,{Sa:!0}).node:e,!e.Ga.Na)throw new u(63);if((e.mode&61440)===16384)throw new u(31);if((e.mode&61440)!==32768)throw new u(28);var n=ge(e,"w");if(n)throw new u(n);e.Ga.Na(e,{size:t,timestamp:Date.now()})},le=(e,t,n,r)=>{if(e==="")throw new u(44);if(typeof t=="string"){var o=ir[t];if(typeof o>"u")throw Error("Unknown file open mode: "+t);t=o}if(n=t&64?(typeof n>"u"?438:n)&4095|32768:0,typeof e=="object")var s=e;else{e=J(e);try{s=B(e,{Sa:!(t&131072)}).node}catch{}}if(o=!1,t&64)if(s){if(t&128)throw new u(20)}else s=He(e,n,0),o=!0;if(!s)throw new u(44);if((s.mode&61440)===8192&&(t&=-513),t&65536&&(s.mode&61440)!==16384)throw new u(54);if(!o&&(n=s?(s.mode&61440)===40960?32:(s.mode&61440)===16384&&(Zt(t)!=="r"||t&512)?31:ge(s,Zt(t)):44))throw new u(n);return t&512&&un(s,0),t&=-131713,r=sr({node:s,path:Ee(s),flags:t,seekable:!0,position:0,Ha:s.Ha,Ib:[],error:!1},r),r.Ha.open&&r.Ha.open(r),!i.logReadFiles||t&1||(Ce||(Ce={}),e in Ce||(Ce[e]=1)),r},_t=e=>{if(e.fd===null)throw new u(8);e.hb&&(e.hb=null);try{e.Ha.close&&e.Ha.close(e)}catch(t){throw t}finally{j[e.fd]=null}e.fd=null},ln=(e,t,n)=>{if(e.fd===null)throw new u(8);if(!e.seekable||!e.Ha.Ta)throw new u(70);if(n!=0&&n!=1&&n!=2)throw new u(28);e.position=e.Ha.Ta(e,t,n),e.Ib=[]},cn=(e,t,n,r,o)=>{if(0>r||0>o)throw new u(28);if(e.fd===null)throw new u(8);if((e.flags&2097155)===1)throw new u(8);if((e.node.mode&61440)===16384)throw new u(31);if(!e.Ha.read)throw new u(28);var s=typeof o<"u";if(!s)o=e.position;else if(!e.seekable)throw new u(70);return t=e.Ha.read(e,t,n,r,o),s||(e.position+=t),t},fn=(e,t,n,r,o,s)=>{if(0>r||0>o)throw new u(28);if(e.fd===null)throw new u(8);if((e.flags&2097155)===0)throw new u(8);if((e.node.mode&61440)===16384)throw new u(31);if(!e.Ha.write)throw new u(28);e.seekable&&e.flags&1024&&ln(e,0,2);var m=typeof o<"u";if(!m)o=e.position;else if(!e.seekable)throw new u(70);return t=e.Ha.write(e,t,n,r,o,s),m||(e.position+=t),t},ur=e=>{var t="binary";if(t!=="utf8"&&t!=="binary")throw Error('Invalid encoding type "'+t+'"');var n,r=le(e,r||0);e=Ie(e).size;var o=new Uint8Array(e);return cn(r,o,0,e,0),t==="utf8"?n=de(o,0):t==="binary"&&(n=o),_t(r),n},pn=()=>{u||(u=function(e,t){this.node=t,this.Hb=function(n){this.Ka=n},this.Hb(e),this.message="FS error"},u.prototype=Error(),u.prototype.constructor=u,[44].forEach(e=>{yt[e]=new u(e),yt[e].stack="<generic error, no stack>"}))},mn,dn=(e,t)=>{var n=0;return e&&(n|=365),t&&(n|=146),n},xe=(e,t,n)=>{e=J("/dev/"+e);var r=dn(!!t,!!n);vt||(vt=64);var o=vt++<<8|0;bt(o,{open:s=>{s.seekable=!1},close:()=>{n&&n.buffer&&n.buffer.length&&n(10)},read:(s,m,_,v)=>{for(var k=0,T=0;T<v;T++){try{var X=t()}catch{throw new u(29)}if(X===void 0&&k===0)throw new u(6);if(X==null)break;k++,m[_+T]=X}return k&&(s.node.timestamp=Date.now()),k},write:(s,m,_,v)=>{for(var k=0;k<v;k++)try{n(m[_+k])}catch{throw new u(29)}return v&&(s.node.timestamp=Date.now()),k}}),Oe(e,r,o)},vt,I={},Ge,Ce;function be(e,t,n){if(t[0]==="/")return t;if(e===-100)e="/";else{if(e=j[e],!e)throw new u(8);e=e.path}if(t.length==0){if(!n)throw new u(44);return e}return J(e+"/"+t)}function Ue(e,t,n){try{var r=e(t)}catch(o){if(o&&o.node&&J(t)!==J(Ee(o.node)))return-54;throw o}return d[n>>2]=r.dev,d[n+4>>2]=0,d[n+8>>2]=r.ino,d[n+12>>2]=r.mode,d[n+16>>2]=r.nlink,d[n+20>>2]=r.uid,d[n+24>>2]=r.gid,d[n+28>>2]=r.rdev,d[n+32>>2]=0,G=[r.size>>>0,(x=r.size,1<=+Math.abs(x)?0<x?(Math.min(+Math.floor(x/4294967296),4294967295)|0)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],d[n+40>>2]=G[0],d[n+44>>2]=G[1],d[n+48>>2]=4096,d[n+52>>2]=r.blocks,d[n+56>>2]=r.atime.getTime()/1e3|0,d[n+60>>2]=0,d[n+64>>2]=r.mtime.getTime()/1e3|0,d[n+68>>2]=0,d[n+72>>2]=r.ctime.getTime()/1e3|0,d[n+76>>2]=0,G=[r.ino>>>0,(x=r.ino,1<=+Math.abs(x)?0<x?(Math.min(+Math.floor(x/4294967296),4294967295)|0)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],d[n+80>>2]=G[0],d[n+84>>2]=G[1],0}var je=void 0;function $e(){return je+=4,d[je-4>>2]}function ne(e){if(e=j[e],!e)throw new u(8);return e}function lr(e,t,n){function r(v){return(v=v.toTimeString().match(/\(([A-Za-z ]+)\)$/))?v[1]:"GMT"}var o=new Date().getFullYear(),s=new Date(o,0,1),m=new Date(o,6,1);o=s.getTimezoneOffset();var _=m.getTimezoneOffset();d[e>>2]=60*Math.max(o,_),d[t>>2]=+(o!=_),e=r(s),t=r(m),e=Ft(e),t=Ft(t),_<o?(d[n>>2]=e,d[n+4>>2]=t):(d[n>>2]=t,d[n+4>>2]=e)}function St(e,t,n){St.Bb||(St.Bb=!0,lr(e,t,n))}var hn;hn=H?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now();var kt={};function yn(){if(!Dt){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:N||"./this.program"},t;for(t in kt)kt[t]===void 0?delete e[t]:e[t]=kt[t];var n=[];for(t in e)n.push(t+"="+e[t]);Dt=n}return Dt}var Dt;function gn(e,t,n,r){e||(e=this),this.parent=e,this.Qa=e.Qa,this.Va=null,this.id=rr++,this.name=t,this.mode=n,this.Ga={},this.Ha={},this.rdev=r}Object.defineProperties(gn.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(e){e?this.mode|=146:this.mode&=-147}}}),pn(),te=Array(4096),nn(w,"/"),K("/tmp"),K("/home"),K("/home/web_user"),(()=>{K("/dev"),bt(259,{read:()=>0,write:(t,n,r,o)=>o}),Oe("/dev/null",259),Qt(1280,tr),Qt(1536,nr),Oe("/dev/tty",1280),Oe("/dev/tty1",1536);var e=Zn();xe("random",e),xe("urandom",e),K("/dev/shm"),K("/dev/shm/tmp")})(),(()=>{K("/proc");var e=K("/proc/self");K("/proc/self/fd"),nn({Qa:()=>{var t=Xt(e,"fd",16895,73);return t.Ga={lookup:(n,r)=>{var o=j[+r];if(!o)throw new u(8);return n={parent:null,Qa:{ub:"fake"},Ga:{readlink:()=>o.path}},n.parent=n}},t}},"/proc/self/fd")})();function bn(e,t){var n=Array(he(e)+1);return e=oe(e,n,0,n.length),t&&(n.length=e),n}var cr={a:function(e,t,n,r){ee("Assertion failed: "+M(e)+", at: "+[t?M(t):"unknown filename",n,r?M(r):"unknown function"])},g:function(e,t){try{return e=M(e),Fe(e,t),0}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return-n.Ka}},I:function(e,t,n){try{if(t=M(t),t=be(e,t),n&-8)var r=-28;else{var o=B(t,{Sa:!0}).node;o?(e="",n&4&&(e+="r"),n&2&&(e+="w"),n&1&&(e+="x"),r=e&&ge(o,e)?-2:0):r=-44}return r}catch(s){if(typeof I>"u"||!(s instanceof u))throw s;return-s.Ka}},h:function(e,t){try{var n=j[e];if(!n)throw new u(8);return Fe(n.node,t),0}catch(r){if(typeof I>"u"||!(r instanceof u))throw r;return-r.Ka}},H:function(e){try{var t=j[e];if(!t)throw new u(8);var n=t.node,r=typeof n=="string"?B(n,{Sa:!0}).node:n;if(!r.Ga.Na)throw new u(63);return r.Ga.Na(r,{timestamp:Date.now()}),0}catch(o){if(typeof I>"u"||!(o instanceof u))throw o;return-o.Ka}},b:function(e,t,n){je=n;try{var r=ne(e);switch(t){case 0:var o=$e();return 0>o?-28:le(r.path,r.flags,0,o).fd;case 1:case 2:return 0;case 3:return r.flags;case 4:return o=$e(),r.flags|=o,0;case 5:return o=$e(),Te[o+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return d[wn()>>2]=28,-1;default:return-28}}catch(s){if(typeof I>"u"||!(s instanceof u))throw s;return-s.Ka}},G:function(e,t){try{var n=ne(e);return Ue(Ie,n.path,t)}catch(r){if(typeof I>"u"||!(r instanceof u))throw r;return-r.Ka}},B:function(e,t){try{var n=j[e];if(!n)throw new u(8);if((n.flags&2097155)===0)throw new u(28);return un(n.node,t),0}catch(r){if(typeof I>"u"||!(r instanceof u))throw r;return-r.Ka}},A:function(e,t){try{return t===0?-28:t<he("/")+1?-68:(oe("/",U,e,t),e)}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return-n.Ka}},E:function(e,t){try{return e=M(e),Ue(an,e,t)}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return-n.Ka}},x:function(e,t){try{return e=M(e),e=J(e),e[e.length-1]==="/"&&(e=e.substr(0,e.length-1)),K(e,t),0}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return-n.Ka}},D:function(e,t,n,r){try{t=M(t);var o=r&256;return t=be(e,t,r&4096),Ue(o?an:Ie,t,n)}catch(s){if(typeof I>"u"||!(s instanceof u))throw s;return-s.Ka}},u:function(e,t,n,r){je=r;try{t=M(t),t=be(e,t);var o=r?$e():0;return le(t,n,o).fd}catch(s){if(typeof I>"u"||!(s instanceof u))throw s;return-s.Ka}},s:function(e,t,n,r){try{if(t=M(t),t=be(e,t),0>=r)var o=-28;else{var s=sn(t),m=Math.min(r,he(s)),_=A[n+m];oe(s,U,n,r+1),A[n+m]=_,o=m}return o}catch(v){if(typeof I>"u"||!(v instanceof u))throw v;return-v.Ka}},r:function(e){try{return e=M(e),rn(e),0}catch(t){if(typeof I>"u"||!(t instanceof u))throw t;return-t.Ka}},F:function(e,t){try{return e=M(e),Ue(Ie,e,t)}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return-n.Ka}},n:function(e,t,n){try{return t=M(t),t=be(e,t),n===0?on(t):n===512?rn(t):ee("Invalid flags passed to unlinkat"),0}catch(r){if(typeof I>"u"||!(r instanceof u))throw r;return-r.Ka}},m:function(e,t,n){try{if(t=M(t),t=be(e,t,!0),n){var r=d[n>>2],o=d[n+4>>2];s=1e3*r+o/1e6,n+=8,r=d[n>>2],o=d[n+4>>2],m=1e3*r+o/1e6}else var s=Date.now(),m=s;e=s;var _=B(t,{Sa:!0}).node;return _.Ga.Na(_,{timestamp:Math.max(e,m)}),0}catch(v){if(typeof I>"u"||!(v instanceof u))throw v;return-v.Ka}},e:function(){return Date.now()},i:function(e,t){e=new Date(1e3*d[e>>2]),d[t>>2]=e.getSeconds(),d[t+4>>2]=e.getMinutes(),d[t+8>>2]=e.getHours(),d[t+12>>2]=e.getDate(),d[t+16>>2]=e.getMonth(),d[t+20>>2]=e.getFullYear()-1900,d[t+24>>2]=e.getDay();var n=new Date(e.getFullYear(),0,1);d[t+28>>2]=(e.getTime()-n.getTime())/864e5|0,d[t+36>>2]=-(60*e.getTimezoneOffset());var r=new Date(e.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),d[t+32>>2]=(r!=n&&e.getTimezoneOffset()==Math.min(n,r))|0},v:function(e,t,n,r,o,s,m){try{var _=j[o];if(!_)return-8;if((n&2)!==0&&(r&2)===0&&(_.flags&2097155)!==2)throw new u(2);if((_.flags&2097155)===1)throw new u(2);if(!_.Ha.ab)throw new u(43);var v=_.Ha.ab(_,e,t,s,n,r),k=v.Fb;return d[m>>2]=v.vb,k}catch(T){if(typeof I>"u"||!(T instanceof u))throw T;return-T.Ka}},w:function(e,t,n,r,o,s){try{var m=j[o];if(m&&n&2){var _=U.slice(e,e+t);m&&m.Ha.bb&&m.Ha.bb(m,_,s,t,r)}}catch(v){if(typeof I>"u"||!(v instanceof u))throw v;return-v.Ka}},j:St,p:function(){return 2147483648},d:hn,o:function(e,t,n){U.copyWithin(e,t,t+n)},c:function(e){var t=U.length;if(e>>>=0,2147483648<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var o=Math;r=Math.max(e,r),o=o.min.call(o,2147483648,r+(65536-r%65536)%65536);e:{try{at.grow(o-lt.byteLength+65535>>>16),Gt();var s=1;break e}catch{}s=void 0}if(s)return!0}return!1},y:function(e,t){var n=0;return yn().forEach(function(r,o){var s=t+n;for(o=d[e+4*o>>2]=s,s=0;s<r.length;++s)A[o++>>0]=r.charCodeAt(s);A[o>>0]=0,n+=r.length+1}),0},z:function(e,t){var n=yn();d[e>>2]=n.length;var r=0;return n.forEach(function(o){r+=o.length+1}),d[t>>2]=r,0},f:function(e){try{var t=ne(e);return _t(t),0}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return n.Ka}},l:function(e,t){try{var n=ne(e);return A[t>>0]=n.tty?2:(n.mode&61440)===16384?3:(n.mode&61440)===40960?7:4,0}catch(r){if(typeof I>"u"||!(r instanceof u))throw r;return r.Ka}},t:function(e,t,n,r){try{e:{for(var o=ne(e),s=e=0;s<n;s++){var m=d[t+(8*s+4)>>2],_=cn(o,A,d[t+8*s>>2],m,void 0);if(0>_){var v=-1;break e}if(e+=_,_<m)break}v=e}return d[r>>2]=v,0}catch(k){if(typeof I>"u"||!(k instanceof u))throw k;return k.Ka}},k:function(e,t,n,r,o){try{var s=ne(e);return e=4294967296*n+(t>>>0),-9007199254740992>=e||9007199254740992<=e?-61:(ln(s,e,r),G=[s.position>>>0,(x=s.position,1<=+Math.abs(x)?0<x?(Math.min(+Math.floor(x/4294967296),4294967295)|0)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],d[o>>2]=G[0],d[o+4>>2]=G[1],s.hb&&e===0&&r===0&&(s.hb=null),0)}catch(m){if(typeof I>"u"||!(m instanceof u))throw m;return m.Ka}},C:function(e){try{var t=ne(e);return t.Ha&&t.Ha.fsync?-t.Ha.fsync(t):0}catch(n){if(typeof I>"u"||!(n instanceof u))throw n;return n.Ka}},q:function(e,t,n,r){try{e:{for(var o=ne(e),s=e=0;s<n;s++){var m=fn(o,A,d[t+8*s>>2],d[t+(8*s+4)>>2],void 0);if(0>m){var _=-1;break e}e+=m}_=e}return d[r>>2]=_,0}catch(v){if(typeof I>"u"||!(v instanceof u))throw v;return v.Ka}}};(function(){function e(o){i.asm=o.exports,at=i.asm.J,Gt(),se=i.asm.Aa,Ut.unshift(i.asm.K),ae--,i.monitorRunDependencies&&i.monitorRunDependencies(ae),ae==0&&(pt!==null&&(clearInterval(pt),pt=null),De&&(o=De,De=null,o()))}function t(o){e(o.instance)}function n(o){return Yn().then(function(s){return WebAssembly.instantiate(s,r)}).then(function(s){return s}).then(o,function(s){re("failed to asynchronously prepare wasm: "+s),ee(s)})}var r={a:cr};if(ae++,i.monitorRunDependencies&&i.monitorRunDependencies(ae),i.instantiateWasm)try{return i.instantiateWasm(r,e)}catch(o){return re("Module.instantiateWasm callback failed with error: "+o),!1}return function(){return Se||typeof WebAssembly.instantiateStreaming!="function"||$t()||F.startsWith("file://")||typeof fetch!="function"?n(t):fetch(F,{credentials:"same-origin"}).then(function(o){return WebAssembly.instantiateStreaming(o,r).then(t,function(s){return re("wasm streaming compile failed: "+s),re("falling back to ArrayBuffer instantiation"),n(t)})})}(),{}})(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.K).apply(null,arguments)},i._sqlite3_free=function(){return(i._sqlite3_free=i.asm.L).apply(null,arguments)};var wn=i.___errno_location=function(){return(wn=i.___errno_location=i.asm.M).apply(null,arguments)};i._sqlite3_step=function(){return(i._sqlite3_step=i.asm.N).apply(null,arguments)},i._sqlite3_finalize=function(){return(i._sqlite3_finalize=i.asm.O).apply(null,arguments)},i._sqlite3_prepare_v2=function(){return(i._sqlite3_prepare_v2=i.asm.P).apply(null,arguments)},i._sqlite3_reset=function(){return(i._sqlite3_reset=i.asm.Q).apply(null,arguments)},i._sqlite3_clear_bindings=function(){return(i._sqlite3_clear_bindings=i.asm.R).apply(null,arguments)},i._sqlite3_value_blob=function(){return(i._sqlite3_value_blob=i.asm.S).apply(null,arguments)},i._sqlite3_value_text=function(){return(i._sqlite3_value_text=i.asm.T).apply(null,arguments)},i._sqlite3_value_bytes=function(){return(i._sqlite3_value_bytes=i.asm.U).apply(null,arguments)},i._sqlite3_value_double=function(){return(i._sqlite3_value_double=i.asm.V).apply(null,arguments)},i._sqlite3_value_int=function(){return(i._sqlite3_value_int=i.asm.W).apply(null,arguments)},i._sqlite3_value_type=function(){return(i._sqlite3_value_type=i.asm.X).apply(null,arguments)},i._sqlite3_result_blob=function(){return(i._sqlite3_result_blob=i.asm.Y).apply(null,arguments)},i._sqlite3_result_double=function(){return(i._sqlite3_result_double=i.asm.Z).apply(null,arguments)},i._sqlite3_result_error=function(){return(i._sqlite3_result_error=i.asm._).apply(null,arguments)},i._sqlite3_result_int=function(){return(i._sqlite3_result_int=i.asm.$).apply(null,arguments)},i._sqlite3_result_int64=function(){return(i._sqlite3_result_int64=i.asm.aa).apply(null,arguments)},i._sqlite3_result_null=function(){return(i._sqlite3_result_null=i.asm.ba).apply(null,arguments)},i._sqlite3_result_text=function(){return(i._sqlite3_result_text=i.asm.ca).apply(null,arguments)},i._sqlite3_column_count=function(){return(i._sqlite3_column_count=i.asm.da).apply(null,arguments)},i._sqlite3_data_count=function(){return(i._sqlite3_data_count=i.asm.ea).apply(null,arguments)},i._sqlite3_column_blob=function(){return(i._sqlite3_column_blob=i.asm.fa).apply(null,arguments)},i._sqlite3_column_bytes=function(){return(i._sqlite3_column_bytes=i.asm.ga).apply(null,arguments)},i._sqlite3_column_double=function(){return(i._sqlite3_column_double=i.asm.ha).apply(null,arguments)},i._sqlite3_column_text=function(){return(i._sqlite3_column_text=i.asm.ia).apply(null,arguments)},i._sqlite3_column_type=function(){return(i._sqlite3_column_type=i.asm.ja).apply(null,arguments)},i._sqlite3_column_name=function(){return(i._sqlite3_column_name=i.asm.ka).apply(null,arguments)},i._sqlite3_bind_blob=function(){return(i._sqlite3_bind_blob=i.asm.la).apply(null,arguments)},i._sqlite3_bind_double=function(){return(i._sqlite3_bind_double=i.asm.ma).apply(null,arguments)},i._sqlite3_bind_int=function(){return(i._sqlite3_bind_int=i.asm.na).apply(null,arguments)},i._sqlite3_bind_text=function(){return(i._sqlite3_bind_text=i.asm.oa).apply(null,arguments)},i._sqlite3_bind_parameter_index=function(){return(i._sqlite3_bind_parameter_index=i.asm.pa).apply(null,arguments)},i._sqlite3_sql=function(){return(i._sqlite3_sql=i.asm.qa).apply(null,arguments)},i._sqlite3_normalized_sql=function(){return(i._sqlite3_normalized_sql=i.asm.ra).apply(null,arguments)},i._sqlite3_errmsg=function(){return(i._sqlite3_errmsg=i.asm.sa).apply(null,arguments)},i._sqlite3_exec=function(){return(i._sqlite3_exec=i.asm.ta).apply(null,arguments)},i._sqlite3_changes=function(){return(i._sqlite3_changes=i.asm.ua).apply(null,arguments)},i._sqlite3_close_v2=function(){return(i._sqlite3_close_v2=i.asm.va).apply(null,arguments)},i._sqlite3_create_function_v2=function(){return(i._sqlite3_create_function_v2=i.asm.wa).apply(null,arguments)},i._sqlite3_open=function(){return(i._sqlite3_open=i.asm.xa).apply(null,arguments)};var ze=i._malloc=function(){return(ze=i._malloc=i.asm.ya).apply(null,arguments)},We=i._free=function(){return(We=i._free=i.asm.za).apply(null,arguments)};i._RegisterExtensionFunctions=function(){return(i._RegisterExtensionFunctions=i.asm.Ba).apply(null,arguments)};var _n=i._emscripten_builtin_memalign=function(){return(_n=i._emscripten_builtin_memalign=i.asm.Ca).apply(null,arguments)},qe=i.stackSave=function(){return(qe=i.stackSave=i.asm.Da).apply(null,arguments)},Ae=i.stackRestore=function(){return(Ae=i.stackRestore=i.asm.Ea).apply(null,arguments)},Y=i.stackAlloc=function(){return(Y=i.stackAlloc=i.asm.Fa).apply(null,arguments)};i.cwrap=function(e,t,n,r){n=n||[];var o=n.every(function(s){return s==="number"});return t!=="string"&&o&&!r?i["_"+e]:function(){return Kn(e,t,n,arguments)}},i.UTF8ToString=M,i.stackSave=qe,i.stackRestore=Ae,i.stackAlloc=Y;var Ke;De=function e(){Ke||Et(),Ke||(De=e)};function Et(){function e(){if(!Ke&&(Ke=!0,i.calledRun=!0,!Ht)){if(i.noFSInit||mn||(mn=!0,pn(),i.stdin=i.stdin,i.stdout=i.stdout,i.stderr=i.stderr,i.stdin?xe("stdin",i.stdin):wt("/dev/tty","/dev/stdin"),i.stdout?xe("stdout",null,i.stdout):wt("/dev/tty","/dev/stdout"),i.stderr?xe("stderr",null,i.stderr):wt("/dev/tty1","/dev/stderr"),le("/dev/stdin",0),le("/dev/stdout",1),le("/dev/stderr",1)),Jt=!1,mt(Ut),i.onRuntimeInitialized&&i.onRuntimeInitialized(),i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;){var t=i.postRun.shift();jt.unshift(t)}mt(jt)}}if(!(0<ae)){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)Jn();mt(Ct),0<ae||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),e()},1)):e())}}if(i.run=Et,i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();return Et(),h}),Ze)};typeof tt=="object"&&typeof fe=="object"?(fe.exports=et,fe.exports.default=et):typeof define=="function"&&define.amd?define([],function(){return et}):typeof tt=="object"&&(tt.Module=et)});var ei={};zr(ei,{default:()=>zn});module.exports=Wr(ei);var D=require("@raycast/api"),it=require("react");var Je=require("react"),Pn=require("@raycast/api");var xt=require("@raycast/api"),qn=["com.lukilabs.lukiapp","com.lukilabs.lukiapp-setapp"],An=()=>(0,xt.getPreferenceValues)();var Mn=()=>(0,xt.getPreferenceValues)();function qt(){let[c,l]=(0,Je.useState)({appExistsLoading:!0,appExists:!1});return(0,Je.useEffect)(()=>{(async()=>{let h=await(0,Pn.getApplications)(),b=An().application,i=h.find(N=>N.bundleId&&qn.includes(N.bundleId));if(!(b||i))return l({appExistsLoading:!1,appExists:!1});l({appExistsLoading:!1,appExists:!0})})()},[]),c}var Xe=require("react");var Ye=require("os"),Q=require("fs"),Me=xn(require("path")),Kr=["com.lukilabs.lukiapp","com.lukilabs.lukiapp-setapp"],[Mt]=Kr.map(c=>Me.default.join((0,Ye.homedir)(),`/Library/Containers/${c}/Data/Library/Application Support/${c}`)).filter(Q.existsSync),Qr=Me.default.join(Mt,"Search"),At=Me.default.join(Mt,"raycast-spaces-config.json"),_e=class{constructor(){this.spaceSettings={};this.primarySpace=()=>this.spaces.find(l=>l.primary);this.buildFilterRegexForExistingRealms=()=>{let l=Mt.replace("~",(0,Ye.homedir)()),p=(0,Q.readdirSync)(l).filter(this.selectRealmFiles).map(this.extractSpaceIDs).filter(h=>h).join("|");return new RegExp(`(?:${p})[^.]*.sqlite$`)};this.selectRealmFiles=l=>l.match(/\.realm$/)!==null;this.extractSpaceIDs=l=>{let p=l.split("_");if(p.length===3)return p[1].split("||").pop()};this.makeSpaceFromStr=(l,p)=>{let h=p.match(/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/g)?.pop()||"",b=this.spaceSettings[h];return{primary:!p.includes("||"),path:Me.default.join(l,p),spaceID:h,customName:b?.customName||null,isEnabled:b?.isEnabled??!0}};this.getSpaceDisplayName=l=>{let p=this.spaces.find(h=>h.spaceID===l);return p?p.customName?p.primary?`${p.customName} (Primary)`:p.customName:p.primary?`${l} (Primary)`:l:l};this.setSpaceCustomName=(l,p)=>{let h=this.spaces.find(b=>b.spaceID===l);h&&(h.customName=p),this.spaceSettings[l]||(this.spaceSettings[l]={customName:null,isEnabled:!0}),this.spaceSettings[l].customName=p,this.saveSpaceSettings()};this.toggleSpaceEnabled=l=>{let p=this.spaces.find(h=>h.spaceID===l);p&&(p.isEnabled=!p.isEnabled),this.spaceSettings[l]||(this.spaceSettings[l]={customName:null,isEnabled:!0}),this.spaceSettings[l].isEnabled=p?.isEnabled??!0,this.saveSpaceSettings()};this.getEnabledSpaces=()=>this.spaces.filter(l=>l.isEnabled);this.getAllSpacesForDropdown=()=>this.getEnabledSpaces().map(l=>({id:l.spaceID,title:this.getSpaceDisplayName(l.spaceID)}));this.loadSpaceSettings=()=>{try{if((0,Q.existsSync)(At)){let l=(0,Q.readFileSync)(At,"utf-8");this.spaceSettings=JSON.parse(l)}else this.spaceSettings={}}catch(l){console.debug(`Failed to load space settings: ${l}`),this.spaceSettings={}}};this.saveSpaceSettings=()=>{try{(0,Q.writeFileSync)(At,JSON.stringify(this.spaceSettings,null,2))}catch(l){console.debug(`Failed to save space settings: ${l}`)}};try{let l=Qr.replace("~",(0,Ye.homedir)()),p=this.buildFilterRegexForExistingRealms();this.loadSpaceSettings(),this.spaces=(0,Q.readdirSync)(l).filter(h=>h.match(p)).map(h=>this.makeSpaceFromStr(l,h))}catch(l){console.debug(`failed getting files: ${l}`),this.spaces=[]}}};function Pt({appExistsLoading:c,appExists:l}){let[p,h]=(0,Xe.useState)({configLoading:!0,config:null}),b=()=>{if(!c){if(!l)return h(S=>({...S,configLoading:!1}));h({configLoading:!1,config:new _e})}},i=()=>{l&&h({configLoading:!1,config:new _e})};return(0,Xe.useEffect)(()=>{b()},[c]),{...p,refreshConfig:i}}var Tn=xn(Rn()),Nn=require("path"),Rt=require("fs"),Ln=require("@raycast/api"),nt=require("react");function Tt({config:c,configLoading:l}){let[{databases:p,databasesLoading:h},b]=(0,nt.useState)({databasesLoading:!0,databases:[]});return(0,nt.useEffect)(()=>{l||c&&Promise.all(c.spaces.map(i=>Vr(i.path).then(S=>({db:S,space:i})))).then(i=>b({databases:i.map(S=>({database:S.db,spaceID:S.space.spaceID})),databasesLoading:!1})).then(()=>console.debug("initialized databases "+c.spaces.map(i=>i.spaceID).join(", ")))},[l]),{databases:p,databasesLoading:h,spaces:c?.spaces}}var Vr=async c=>{let l=(0,Rt.readFileSync)((0,Nn.join)(Ln.environment.assetsPath,"sql-wasm-fts5.wasm")),p=await(0,Tn.default)({wasmBinary:l});return new p.Database((0,Rt.readFileSync)(c))};var rt=require("react");var Bn=`
SELECT id, content, type, entityType, documentId
FROM BlockSearch(?)
ORDER BY rank + customRank
LIMIT ?
`,Hn=`
SELECT id, content, type, entityType, documentId
FROM BlockSearch
ORDER BY customRank
LIMIT ?
`;var Nt=40,On=c=>{if(!c||c.length===0)return"";let l=Yr(c);return`{content exactMatchContent} : (${Xr(l).join(") OR (")})`},Fn=(c,l,p,h)=>{try{return c.exec(p,h).map(b=>b.values).flat().map(Zr(l))}catch(b){return console.error(`db exec error: ${b}`),[]}},Gn=(c,l)=>{if(l.length===0)return[];let p=Jr(l),b=`select documentId, content from BlockSearch where entityType = 'document' and documentId in (${new Array(p.length).fill("?").join(", ")})`;try{return c.exec(b,p).map(i=>i.values).flat().map(([i,S])=>l.filter(N=>N.documentID===i).forEach(N=>N.documentName=S)),l}catch(i){return console.error(`db exec error: ${i}`),[]}};var Jr=c=>[...new Set(c.map(l=>l.documentID))],Yr=c=>c.split(/\s+/).map(l=>l.trim()).map(l=>l.replace('"'," ")).map(l=>`"${l}"`),Xr=c=>{let l=[c.join(" "),c.join(" ")+"*"];return c.length>1&&l.push(c.join("* ")+"*"),l},Zr=c=>([l,p,h,b,i])=>({id:l,content:p,type:h,entityType:b,documentID:i,spaceID:c});function Lt({databasesLoading:c,databases:l},p){let[h,b]=(0,rt.useState)({resultsLoading:!0,results:[]});return(0,rt.useEffect)(()=>{if(c)return;b(H=>({...H,resultsLoading:!0}));let i=On(p),[S,N]=i.length>0?[Bn,[i,Nt]]:[Hn,[Nt]],W=l.map(({database:H,spaceID:P})=>({database:H,blocks:Fn(H,P,S,N)})).map(({database:H,blocks:P})=>Gn(H,P)).flat();b({results:W,resultsLoading:!1}),console.debug(`got ${W.length} results for query search '${p}'`)},[c,p]),h}var Bt={BEGINNING:"0",END:"999999"};var Cn={HH:c=>c.getHours().toString().padStart(2,"0"),H:c=>c.getHours().toString(),hh:c=>(c.getHours()%12||12).toString().padStart(2,"0"),h:c=>(c.getHours()%12||12).toString(),mm:c=>c.getMinutes().toString().padStart(2,"0"),m:c=>c.getMinutes().toString(),ss:c=>c.getSeconds().toString().padStart(2,"0"),s:c=>c.getSeconds().toString(),A:c=>c.getHours()>=12?"PM":"AM",a:c=>c.getHours()>=12?"pm":"am"};function Un(c,l){let p=l,h=Object.keys(Cn).sort((b,i)=>i.length-b.length);for(let b of h){let i=new RegExp(b,"g");p=p.replace(i,Cn[b](c))}return p}function jn(c){let l=c.getFullYear(),p=(c.getMonth()+1).toString().padStart(2,"0"),h=c.getDate().toString().padStart(2,"0");return`${l}.${p}.${h}`}var C=require("react/jsx-runtime"),$n=(c,l)=>{let p=c;return l.addTimestamp?p=`**${Un(new Date,l.timeFormat)}**${l.contentPrefix}${p}`:p=`${l.contentPrefix}${p}`,p=`${p}${l.contentSuffix}`,p};function zn(){let c=qt(),l=Pt(c),p=l?.config||null,h=l?.configLoading||!1,b=Mn(),i=Tt(l),[S,N]=(0,it.useState)({content:"",spaceId:""}),W=jn(new Date),{resultsLoading:H,results:P}=Lt(i,W),ve=()=>{if(!P)return null;let E=P.filter(R=>R.entityType==="document"&&R.spaceID===S.spaceId);return E.length>0?E[0].id:null};(0,it.useEffect)(()=>{p&&p.primarySpace()&&!S.spaceId&&N(E=>({...E,spaceId:p.primarySpace()?.spaceID||""}))},[p,S.spaceId]);let Z=()=>{if(!S.content.trim()){(0,D.showHUD)("\u274C Content is required");return}if(!S.spaceId){(0,D.showHUD)("\u274C Space is required");return}if(!c.appExists){(0,D.showHUD)("\u274C Craft app is not installed");return}let E=$n(S.content,b);D.Clipboard.copy(E);let R=b.appendPosition==="beginning"?"prepended to":"appended to";(0,D.showHUD)(`\u2705 Content ${R} daily note (also copied to clipboard)`),(0,D.popToRoot)(),(0,D.closeMainWindow)()},pe=()=>{let E=ve();if(!E||!S.spaceId)return null;let R=$n(S.content,b),Re=b.appendPosition==="beginning"?Bt.BEGINNING:Bt.END;return`craftdocs://createblock?parentBlockId=${E}&spaceId=${S.spaceId}&content=${encodeURIComponent(R)}&index=${Re}`},me=()=>S.spaceId?`craftdocs://openByQuery?query=today&spaceId=${S.spaceId}`:null;return!c.appExists&&!c.appExistsLoading?(0,C.jsx)(D.Form,{children:(0,C.jsx)(D.Form.Description,{text:"Craft app is not installed. Please install Craft to use this extension."})}):(0,C.jsxs)(D.Form,{isLoading:h||c.appExistsLoading||H,navigationTitle:"Add to Daily Note",actions:(0,C.jsx)(D.ActionPanel,{children:(()=>{let E=pe(),R=me();return E&&S.content.trim()&&S.spaceId?(0,C.jsx)(D.Action.OpenInBrowser,{title:"Add to Daily Note",icon:D.Icon.Plus,url:E,onOpen:Z}):R&&S.content.trim()&&S.spaceId?(0,C.jsx)(D.Action.OpenInBrowser,{title:"Create Daily Note & Copy Content",icon:D.Icon.Calendar,url:R,onOpen:Z}):(0,C.jsx)(D.Action.SubmitForm,{title:"Add to Daily Note",icon:D.Icon.Plus,onSubmit:Z})})()}),children:[(0,C.jsx)(D.Form.TextArea,{id:"content",title:"Content",placeholder:"What would you like to add to today's daily note?",value:S.content,onChange:E=>N(R=>({...R,content:E})),info:"This content will be added to today's daily note with a timestamp"}),(0,C.jsx)(D.Form.Dropdown,{id:"spaceId",title:"Space",value:S.spaceId,onChange:E=>N(R=>({...R,spaceId:E})),children:p?.getEnabledSpaces().map(E=>(0,C.jsx)(D.Form.Dropdown.Item,{value:E.spaceID,title:p.getSpaceDisplayName(E.spaceID)},E.spaceID))})]})}
