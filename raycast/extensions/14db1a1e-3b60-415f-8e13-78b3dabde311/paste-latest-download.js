"use strict";var U=Object.create;var p=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},v=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of I(t))!D.call(e,c)&&c!==r&&p(e,c,{get:()=>t[c],enumerable:!(a=C(t,c))||a.enumerable});return e};var m=(e,t,r)=>(r=e!=null?U(O(e)):{},v(t||!e||!e.__esModule?p(r,"default",{value:e,enumerable:!0}):r,e)),L=e=>v(p({},"__esModule",{value:!0}),e);var N={};M(N,{default:()=>P});module.exports=L(N);var s=require("@raycast/api");var u=m(require("react")),n=require("@raycast/api");var f=m(require("node:fs")),b=m(require("node:path"));var E=require("react/jsx-runtime");function g(e,t){let r=e instanceof Error?e.message:String(e);return(0,n.showToast)({style:n.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??S(e),secondaryAction:t?.primaryAction?S(e):void 0})}var S=e=>{let t=!0,r="[Extension Name]...",a="";try{let i=JSON.parse((0,f.readFileSync)((0,b.join)(n.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,a=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let c=n.environment.isDevelopment||t,x=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:c?"Copy Logs":"Report Error",onAction(i){i.hide(),c?n.Clipboard.copy(x):(0,n.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(a)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${x}
\`\`\`
`)}`)}}};var o=require("@raycast/api");var l=require("fs");var T=require("path");var w=m(require("node:os"),1),h,$;function k(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(h===void 0&&(h=w.default.homedir()),h&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,h);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&($===void 0&&($=w.default.userInfo().username),$)){let r=t[1],a=t[2];if(r===$)return h+a}return e}var W=require("react/jsx-runtime"),d=(0,o.getPreferenceValues)(),A=k(d.downloadsFolder??"~/Downloads"),z=d.showHiddenFiles,V=d.fileOrder,y=d.lastestDownloadOrder,Y=d.downloadsLayout??"list";function F(){return(0,l.readdirSync)(A).filter(t=>z||!t.startsWith(".")).map(t=>{let r=(0,T.join)(A,t),a=(0,l.statSync)(r);return{file:t,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}).sort((t,r)=>{switch(V){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function R(){let e=F();if(!(e.length<1))return y==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):y==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):y==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):y==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function _(){try{return(0,l.accessSync)(d.downloadsFolder,l.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function P(){if(!_()){await(0,s.showHUD)("No permission to access the downloads folder");return}let e;try{e=R()}catch(t){await g(t,{title:"Could not get latest download"});return}if(!e){await(0,s.showHUD)("No downloads found");return}try{await s.Clipboard.paste({file:e.path}),await(0,s.closeMainWindow)(),await(0,s.showHUD)("Pasted latest download"),await(0,s.popToRoot)()}catch(t){await g(t,{title:"Could not paste download"})}}
