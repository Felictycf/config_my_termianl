"use strict";var D=Object.create;var m=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var W=(e,t)=>{for(var a in t)m(e,a,{get:t[a],enumerable:!0})},A=(e,t,a,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of M(t))!V.call(e,u)&&u!==a&&m(e,u,{get:()=>t[u],enumerable:!(c=L(t,u))||c.enumerable});return e};var T=(e,t,a)=>(a=e!=null?D(F(e)):{},A(t||!e||!e.__esModule?m(a,"default",{value:e,enumerable:!0}):a,e)),z=e=>A(m({},"__esModule",{value:!0}),e);var J={};W(J,{default:()=>H});module.exports=z(J);var r=require("@raycast/api"),x=require("react");var o=require("@raycast/api");var f=T(require("react")),i=require("@raycast/api");var R=require("react/jsx-runtime");var l=require("fs");var P=require("path");var $=T(require("node:os"),1),h,g;function w(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(h===void 0&&(h=$.default.homedir()),h&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,h);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(g===void 0&&(g=$.default.userInfo().username),g)){let a=t[1],c=t[2];if(a===g)return h+c}return e}var p=require("react/jsx-runtime"),d=(0,o.getPreferenceValues)(),b=w(d.downloadsFolder??"~/Downloads"),N=d.showHiddenFiles,j=d.fileOrder,ae=d.lastestDownloadOrder,_=d.downloadsLayout??"list",B=[".png",".jpg",".jpeg",".gif",".webp",".bmp",".tiff",".heic",".svg"];function U(e){let t=e.lastIndexOf(".");if(t===-1)return!1;let a=e.toLowerCase().slice(t);return B.includes(a)}function k(){return(0,l.readdirSync)(b).filter(t=>N||!t.startsWith(".")).map(t=>{let a=(0,P.join)(b,t),c=(0,l.statSync)(a);return{file:t,path:a,lastModifiedAt:c.mtime,createdAt:c.ctime,addedAt:c.atime,birthAt:c.birthtime}}).sort((t,a)=>{switch(j){case"addTime":return a.addedAt.getTime()-t.addedAt.getTime();case"createTime":return a.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return a.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function G(){try{return(0,l.accessSync)(d.downloadsFolder,l.constants.R_OK),!0}catch(e){return console.error(e),!1}}var C=e=>t=>G()?((0,l.accessSync)(d.downloadsFolder,l.constants.R_OK),(0,p.jsx)(e,{...t})):(0,p.jsx)(o.Detail,{markdown:`## Permission Required

The Downloads Manager extension requires access to your Downloads folder. Please grant permission to use it.

![Grant Permission](permission.png)`,actions:(0,p.jsx)(o.ActionPanel,{children:(0,p.jsx)(o.Action.Open,{title:"Grant Permission",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"})})});var s=require("react/jsx-runtime");function K(){let[e,t]=(0,x.useState)(k()),[a,c]=(0,x.useState)(_);function u(n){t(y=>y.filter(E=>Array.isArray(n)?!n.includes(E.path):n!==E.path))}function I(){t(k())}let O=n=>(0,s.jsxs)(r.ActionPanel,{children:[(0,s.jsxs)(r.ActionPanel.Section,{children:[(0,s.jsx)(r.Action.Open,{title:"Open File",target:n.path}),(0,s.jsx)(r.Action.ShowInFinder,{path:n.path}),(0,s.jsx)(r.Action.CopyToClipboard,{title:"Copy File",content:{file:n.path},shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,s.jsx)(r.Action,{title:"Reload Downloads",icon:r.Icon.RotateAntiClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:I})]}),(0,s.jsxs)(r.ActionPanel.Section,{children:[(0,s.jsx)(r.Action.OpenWith,{path:n.path,shortcut:{modifiers:["cmd"],key:"o"}}),(0,s.jsx)(r.Action.ToggleQuickLook,{shortcut:{modifiers:["cmd"],key:"y"}}),(0,s.jsx)(r.Action,{title:"Toggle Layout",icon:a==="list"?r.Icon.AppWindowGrid3x3:r.Icon.AppWindowList,shortcut:{modifiers:["cmd"],key:"l"},onAction:()=>c(a==="list"?"grid":"list")})]}),(0,s.jsxs)(r.ActionPanel.Section,{children:[(0,s.jsx)(r.Action.Trash,{title:"Delete Download",paths:n.path,shortcut:{modifiers:["ctrl"],key:"x"},onTrash:u}),(0,s.jsx)(r.Action.Trash,{title:"Delete All Downloads",paths:e.map(y=>y.path),shortcut:{modifiers:["ctrl","shift"],key:"x"},onTrash:u})]})]}),v={icon:{fileIcon:b},title:"No downloads found",description:"Well, first download some files \xAF\\_(\u30C4)_/\xAF"},S=n=>({title:n.file,quickLook:{path:n.path,name:n.file},actions:O(n)});return a==="grid"?(0,s.jsxs)(r.Grid,{columns:8,children:[e.length===0&&(0,s.jsx)(r.Grid.EmptyView,{...v}),e.map(n=>(0,s.jsx)(r.Grid.Item,{...S(n),content:U(n.file)?{source:n.path}:{fileIcon:n.path}},n.path))]}):(0,s.jsxs)(r.List,{children:[e.length===0&&(0,s.jsx)(r.List.EmptyView,{...v}),e.map(n=>(0,s.jsx)(r.List.Item,{...S(n),icon:{fileIcon:n.path},accessories:[{date:n.lastModifiedAt,tooltip:`Last modified: ${n.lastModifiedAt.toLocaleString()}`}]},n.path))]})}var H=C(K);
