"use strict";var I=Object.create;var m=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var F=(e,t)=>{for(var r in t)m(e,r,{get:t[r],enumerable:!0})},v=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of D(t))!L.call(e,o)&&o!==r&&m(e,o,{get:()=>t[o],enumerable:!(s=O(t,o))||s.enumerable});return e};var b=(e,t,r)=>(r=e!=null?I(M(e)):{},v(t||!e||!e.__esModule?m(r,"default",{value:e,enumerable:!0}):r,e)),z=e=>v(m({},"__esModule",{value:!0}),e);var B={};F(B,{default:()=>C});module.exports=z(B);var a=require("@raycast/api");var l=b(require("react")),n=require("@raycast/api");var u=b(require("node:fs")),g=b(require("node:path"));var E=require("react/jsx-runtime");function d(e,t){let r=e instanceof Error?e.message:String(e);return(0,n.showToast)({style:n.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??S(e),secondaryAction:t?.primaryAction?S(e):void 0})}var S=e=>{let t=!0,r="[Extension Name]...",s="";try{let i=JSON.parse((0,u.readFileSync)((0,g.join)(n.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,s=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let o=n.environment.isDevelopment||t,x=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:o?"Copy Logs":"Report Error",onAction(i){i.hide(),o?n.Clipboard.copy(x):(0,n.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(s)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${x}
\`\`\`
`)}`)}}};var c=require("fs"),T=require("fs/promises"),R=require("path");var w=b(require("node:os"),1),h,$;function k(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(h===void 0&&(h=w.default.homedir()),h&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,h);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&($===void 0&&($=w.default.userInfo().username),$)){let r=t[1],s=t[2];if(r===$)return h+s}return e}var j=require("react/jsx-runtime"),f=(0,a.getPreferenceValues)(),A=k(f.downloadsFolder??"~/Downloads"),V=f.showHiddenFiles,W=f.fileOrder,y=f.lastestDownloadOrder,Q=f.downloadsLayout??"list";function N(){return(0,c.readdirSync)(A).filter(t=>V||!t.startsWith(".")).map(t=>{let r=(0,R.join)(A,t),s=(0,c.statSync)(r);return{file:t,path:r,lastModifiedAt:s.mtime,createdAt:s.ctime,addedAt:s.atime,birthAt:s.birthtime}}).sort((t,r)=>{switch(W){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function _(){let e=N();if(!(e.length<1))return y==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):y==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):y==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):y==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function P(){try{return(0,c.accessSync)(f.downloadsFolder,c.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function U(e){if(f.deletionBehavior==="trash"){try{await(0,a.trash)(e),await(0,a.showToast)({style:a.Toast.Style.Success,title:"Item Moved to Trash"})}catch(r){await d(r,{title:"Move to Trash Failed"})}return}if(!await(0,a.confirmAlert)({title:"Delete Item?",message:`Are you sure you want to permanently delete:
${e}?`,primaryAction:{title:"Delete"}})){await(0,a.showToast)({style:a.Toast.Style.Animated,title:"Cancelled"});return}try{(0,T.rm)(e,{recursive:!0,force:!0}),await(0,a.showToast)({style:a.Toast.Style.Success,title:"Item Deleted"})}catch(r){r instanceof Error&&await d(r,{title:"Deletion Failed"})}}var p=require("@raycast/api");async function C(){if(!P()){await(0,p.showHUD)("No permission to access the downloads folder");return}let e=_();if(!e){await(0,p.showHUD)("No downloads found");return}try{await U(e.path)}catch(t){await d(t,{title:"Deletion Failed"})}await(0,p.popToRoot)()}
